{"paragraphs":[{"title":"Ficheros de datos","text":"%md\nLos ficheros que contienen los datos debes ponerlos en el directorio data dentro de la carpeta de zeppelin","dateUpdated":"2018-04-07T11:38:46+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926423_-1568103702","id":"20161129-184647_901381722","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:529"},{"text":"%sh\nls ./data/*.dat\n","user":"anonymous","dateUpdated":"2018-04-07T11:53:56+0200","config":{"editorSetting":{"language":"sh","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"./data/movies.dat\n./data/ratings.dat\n./data/users.dat\n"}]},"apps":[],"jobName":"paragraph_1523093926425_-1570412196","id":"20161129-184944_96018825","dateCreated":"2018-04-07T11:38:46+0200","dateStarted":"2018-04-07T11:53:56+0200","dateFinished":"2018-04-07T11:53:57+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:530"},{"title":"1","text":"%md\n#### Crea un RDD que lea el fichero Movie y luego lista 5 elementos:","dateUpdated":"2018-04-07T11:38:46+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926426_-1569257949","id":"20161129-190233_2095066170","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:531"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:54:48+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926427_-1569642698","id":"20161129-191153_1272754847","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:532"},{"title":"2","text":"%md\n#### Crea un RDD que lea el fichero Users y luego lista 5 elementos:\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926428_-1571566442","id":"20161129-190539_27488415","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:533"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:56:07+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926428_-1571566442","id":"20161129-191207_2032801755","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:534"},{"title":"3","text":"%md\n#### Crea un RDD que lea el fichero Ratings y luego lista 5 elementos:\n","dateUpdated":"2018-04-07T11:56:09+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926429_-1571951191","id":"20161129-190536_1271867169","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:535"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926429_-1571951191","id":"20161129-191209_667283434","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:536"},{"title":"4","text":"%md\nCrea una de estructura de datos para Users","dateUpdated":"2018-04-07T11:57:10+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926430_-1570796944","id":"20161130-193812_488567325","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:537"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926430_-1570796944","id":"20161130-193811_294125664","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:538"},{"title":"5","text":"%md\nCrea una estructura de datos para Movies\n","dateUpdated":"2018-04-07T15:52:34+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926430_-1570796944","id":"20161130-193810_1137767662","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:539"},{"text":"%pyspark","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926431_-1571181693","id":"20161130-193802_2044691436","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:540"},{"title":"6","text":"%md\nCrea una estructura de datos para Ratings\n","user":"anonymous","dateUpdated":"2018-04-07T15:53:24+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109158793_-938259062","id":"20180407-155238_1908928975","dateCreated":"2018-04-07T15:52:38+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:541"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:53:13+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109183303_-1875476734","id":"20180407-155303_643494648","dateCreated":"2018-04-07T15:53:03+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:542"},{"title":"7","text":"%md\n### Define una función que lea una línea del fichero de users y devuelva un objeto de tipo User  \n","dateUpdated":"2018-04-07T15:53:35+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926431_-1571181693","id":"20161129-191459_1396458300","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:543"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":false,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926432_-1585417403","id":"20161130-193801_1421633596","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:544"},{"title":"8","text":"%md\n### Define una función que lea una línea del fichero de movies y devuelva un objeto de tipo Movie  \n","dateUpdated":"2018-04-07T15:53:43+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926432_-1585417403","id":"20161129-191340_86536524","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:545"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926433_-1585802152","id":"20161130-193758_1763702278","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:546"},{"title":"9","text":"%md\n### Define una función que lea una línea del fichero de ratings y devuelva un objeto de tipo Ratings\n","dateUpdated":"2018-04-07T15:53:55+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926433_-1585802152","id":"20161130-204146_1266646263","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:547"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926434_-1584647905","id":"20161130-204144_694238566","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:548"},{"title":"10","text":"%md\n### Usando las funciones anteriores crea un dataframe para Users, Movies y Ratings\n","dateUpdated":"2018-04-07T15:54:04+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926434_-1584647905","id":"20161129-191344_456687842","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:549"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926435_-1585032654","id":"20161130-195414_1290333370","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:550"},{"title":"11","text":"%md\n### Muestra el schema de Users y lista los 20 primeros elementos del dataframe","dateUpdated":"2018-04-07T15:54:09+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926435_-1585032654","id":"20161129-193750_1643842647","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:551"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926436_-1586956398","id":"20161130-195430_1512405208","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:552"},{"title":"12","text":"%md\n### Registra una tabla temporal para los datos de User, Ratings y otra para la de Movies\n","dateUpdated":"2018-04-07T15:54:20+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926436_-1586956398","id":"20161129-193706_1195002254","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:553"},{"text":"%pyspark\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926437_-1587341147","id":"20161129-193758_1125742796","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:554"},{"title":"13","text":"%md\n### Aprovechando los Dataframes que hemos creado y las funciones de Spark SQL, vamos a realizar una serie de consultas para familiarizarnos con los datos:\n#### Obtén la mayor y la menor valoración así como el número de usuarios que dieron esas valoraciones. Lista los 20 primeros resultados\n","dateUpdated":"2018-04-07T15:54:34+0200","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926437_-1587341147","id":"20161129-194301_3473336","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:555"},{"text":"%sql\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926438_-1586186900","id":"20161129-195453_2019542101","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:556"},{"title":"14","text":"%md\n#### Lista los 10 usuarios más activos y el número de veces que valoraron una película","dateUpdated":"2018-04-07T15:54:39+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926438_-1586186900","id":"20161129-195445_1552374375","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:557"},{"text":"%sql\n\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926438_-1586186900","id":"20161129-193801_927913516","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:558"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:54:51+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109282169_393957814","id":"20180407-155442_740399834","dateCreated":"2018-04-07T15:54:42+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:559"},{"title":"15","text":"%md\n#### Muestra las películas que el usuario 4169 valoró con más de 4\n\n","dateUpdated":"2018-04-07T15:54:55+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926439_-1586571649","id":"20161129-191323_108570711","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:560"},{"text":"%sql\n","dateUpdated":"2018-04-07T11:38:46+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926439_-1586571649","id":"20161129-191500_168382403","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:561"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:55:07+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109295679_-1847589278","id":"20180407-155455_10116425","dateCreated":"2018-04-07T15:54:55+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:562"},{"title":"16.Ejercicio ALS","text":"%pyspark\n\n# Crea un dataset de datos con el 80% de los datos y otro de test con el resto\n\n# Usa la función randomSplit\n\n# En el split(0) que te devuelve randomSplit tienes el RDD de training y el en 1 el de test\n\n# TIP: Para mejorar el rendimiento del proceso cachea los RDDs\n\n\n# ¿Cuántos elementos tiene el RDD de training?\n\n# ¿Y el de test?\n\n# Construye la matriz usuarios/productos de ALS con un rank=20 e iterations=10\n# En Scala:\n# val model = (new ALS().setRank(20).setIterations(10).run(trainingRatingsRDD))\n\n# Obtén las 5 películas recomendadas para el usuario \n# model.recommendProducts(4169, 5)\n\n\n\n# Lista los títulos de las 5 películas anteriores\n\n\n# Evalúa el modelo usando Mean Absolute Error (MAE) entre el test y la predicción\n","user":"anonymous","dateUpdated":"2018-04-07T15:55:18+0200","config":{"editorSetting":{"language":"python","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"graph":{"mode":"table","height":139.5,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/var/folders/0n/2zz4ghy53lx_w0p275nql_bm0000gn/T/zeppelin_pyspark-800642989613880167.py\", line 349, in <module>\n    [code.body[-(nhooks + 1)]])\nIndexError: list index out of range\n"}]},"apps":[],"jobName":"paragraph_1523093926440_-1588495394","id":"20161125-180809_858618071","dateCreated":"2018-04-07T11:38:46+0200","dateStarted":"2018-04-07T12:06:08+0200","dateFinished":"2018-04-07T12:06:21+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:563"},{"title":"17. Ejercicio Spark Streaming (básico)","text":"%md\n# Se verá en clase","dateUpdated":"2018-04-07T15:55:39+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926440_-1588495394","id":"20161125-180700_1317639255","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:564"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:55:49+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109339281_-1169048749","id":"20180407-155539_1480182473","dateCreated":"2018-04-07T15:55:39+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:565"},{"title":"18. Ejercicio Spark Streaming (avanzado)","text":"%md\n# Crear u job de streaming pero que en lugar de devolver el identificador de la película, devuelva su título","user":"anonymous","dateUpdated":"2018-04-07T15:59:26+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","title":true,"results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109351817_1639248797","id":"20180407-155551_1140466088","dateCreated":"2018-04-07T15:55:51+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:566"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:56:41+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109385054_1651606734","id":"20180407-155625_807557676","dateCreated":"2018-04-07T15:56:25+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:567"},{"title":"19.Publicación del modelo mediante una UDF","text":"%md\n# Crea una función UDF que permita explotar el motor de recomendaciones desde SQL estándard","user":"anonymous","dateUpdated":"2018-04-07T16:00:12+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109386221_1287249526","id":"20180407-155626_2139705046","dateCreated":"2018-04-07T15:56:26+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:568"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-04-07T15:57:07+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523109402072_-1613925747","id":"20180407-155642_630239182","dateCreated":"2018-04-07T15:56:42+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:569"},{"title":"Realiza una consulta usando la UDF anterior","text":"%sql\n","dateUpdated":"2018-04-07T15:59:18+0200","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","results":{},"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1523093926441_-1588880143","id":"20161130-202534_41007586","dateCreated":"2018-04-07T11:38:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:570"}],"name":"Datahack/07.Evaluación_Modulo_v.02","id":"2D9NJZ2HP","angularObjects":{"2D4K4KNU8:shared_process":[],"2CYC5EH88:shared_process":[],"2D1Q9ZN26:shared_process":[],"2D287MU4K:shared_process":[],"2D8XYTQSZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}